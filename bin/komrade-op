##
# Run THE OPERATOR
##

# settings
export KOMRADE_SHOW_LOG=1

# get virtualenv going
SCRIPTPATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
path=`realpath "$SCRIPTPATH/../komrade/backend/switchboard.py"`
source "`which komrade-activate`"
pathreqs=`realpath "$SCRIPTPATH/../requirements.txt"`
python -m pip install -r "$pathreqs"

# run op forever
cmd="python $path 8080 $*"
while true; do $cmd && break; done

#if command -v deactivate &> /dev/null
#then
#    deactivate
#fi
